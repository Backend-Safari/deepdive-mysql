# 8.4 전문 검색 인덱스

## 인덱스 알고리즘
- 전문 검색 인덱스는 문서의 키워드를 인덱싱하는 기법에 따라 크게 단어의 어근 분석과 n-gram 분석 알고리즘으로 구분할 수 있다.

## 어근 분석 알고리즘
- MySQL 서버의 전문 검색 인덱스는 두 가지 중요한 과정을 거쳐서 색인 작업이 수행된다.
  - 불용어(Stop Word) 처리
  - 어근 분석 (Stemming)
- 불용어 처리는 검색에서 별 가치가 없는 단어를 모두 필터링해서 제거하는 작업을 의미한다.
- 어근 분석은 검색어로 선정된다언의 뿌리인 원형을 찾는 작업이다.
- MeCab을 MySQL 서버에 적용하는 방법은 어렵지 않지만 한글에 맞게 완성도를 갖추는 작업은 많은 시간과 노력이 필요하다.

## n-gram 알고리즘
- 형태소 분석이 문장을 이해하는 알고리즘이라면, n-gram은 단수히 키워드를 검색해내기 위한 인덱싱 알고리즘이라고 할 수 있다.
- n-gram은 무조건 몇 글자씩 잘라서 인덱싱하는 방법이다.
- 일반적으로는 2글자 단위로 키워드를 쪼개서 인덱싱하는 2-gram(또는 Bi-gram이라고도 한다)
- 기본적으로 MySQL 서버에 내장된 불용어는 다음과 같이 information_schema.innodb_ft_default_stopword 테이블을 통해 확인 할 수 있다.

## 불용어 변경 및 삭제
- 불용어 처리를 무시하는 방법은 두 가지가 있다.
- 첫 번째, 스토리지 엔진에 관계없이 MySQL 서버의 모든 전문 검색 인덱스에 대해 불용어를 완전히 제거하는 것이다.
- 두 번째, InnoDB 스토리지 엔진을 사용하는 테이블의 전문 검색 인덱스에 대해서만 불용어 처리를 무시할 수도 있다.

## 사용자 정의 불용어 사용
- 불용어 목록을 파일로 저장하고, MySQL 서버 설정 파일에서 파일의 경로를 다음과 같이 설정에 등록하면 된다.
ft_stopword_file='/data/my_custom_stopword.txt'
- InnoDB 스토리지 엔진을 사용하는 테이블의 전문 검색 엔진에서만 사용할 수 있는데, 불용어의 목록을 테이블로 저장하는 방식.

## 전문 검색 인덱스의 가용성
- 전문 검색 인덱스를 사용하려면 반드시 다음 두 가지 조건을 갖춰야 한다.
  - 쿼리 문장이 전문 검색을 위한 문법 (MATCH ... AGAINST ...)을 사용
  - 테이블이 전문 검색 대상 칼럼에 대해서 전문 인덱스 보유
- 전문 검색 인덱스를 사용하려면 반드시 다음 예제와 같이 MATCH(...) AGAINST(...) 구문으로 검색 쿼리를 작성해야 하면, 전문 검색 인덱스를 구성하는 칼럼들은 MATCH 절의 괄호 안에 모두 명시돼야 한다.
```
mysql > SELECT * FROM db_test
        where match(doc_body) against('애플' in boolean mode);
```